# Exploiting a mass assignment vulnerability
# Objective
To solve the lab, find and exploit a mass assignment vulnerability to buy a Lightweight l33t Leather Jacket. You can log in to your own account using the following credentials: `wiener:peter`. 

To solve this lab, you'll need to know:
- What mass assignment is.
- Why mass assignment may result in hidden parameters.
- How to identify hidden parameters.
- How to exploit mass assignment vulnerabilities.


# Solution
## Analysis
Initially application do not allow to buy item which price is above `Store credit`.
|![](Images/image-12.png)|
|:--:| 
| *Checkout request* |

The HTTP `201 Created successful` response status code indicates that the HTTP request has led to the creation of a resource. This status code is commonly sent as the result of a POST request. 

Request to `/api/checkout` shows all JSON parametrs.
|![](Images/image-16.png)|
|:--:| 
| *All JSON parametrs* |

## Exploitation
### Finding hidden parameters - Param Miner example
Param Miner enumeration shows that all requests with extra JSON parameters are accepted. Response `201 Created` indicates that mass assignment vulnerability may exist.

|![](Images/image-13.png)|
|:--:| 
| *Param Miner start* |
|![](Images/image-15.png)|
| *Param Miner configuratoin* |
|![](Images/image-14.png)|
| *Param Miner result* |

### Exploiting mass assignment vulnerability

Full expplanation [Mass Assigment vulnerability](https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html)

> Software frameworks sometimes allow developers to automatically bind HTTP request parameters into program code variables or objects to make using that framework easier on developers. This can sometimes cause harm. Attackers can sometimes use this methodology to create new parameters that the developer never intended which in turn creates or overwrites new variable or objects in program code that was not intended.


|![](Images/image-17.png)|
|:--:| 
| *Successful request with extra parameter* |
|![](Images/image-18.png)|
| *Successful request with modified checkout parameter value* |
