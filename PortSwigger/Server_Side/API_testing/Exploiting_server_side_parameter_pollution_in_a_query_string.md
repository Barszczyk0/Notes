# Exploiting server-side parameter pollution in a query string
# Objective
To solve the lab, log in as the administrator and delete carlos. 


# Solution
## Analysis

|![](Images/image-19.png)|
|:--:| 
| *Password reset funcionality* |

## Exploitation
### Parameter pollution techniques
Parameter pollution techniques: 
- Truncating query strings `%23` (`#`)
- Injecting invalid parameters `%26` (`&`)
- Injecting valid parameters - finding parameters 
- Overriding existing parameters `GET /getUser?name=tom%26name=jerry`

### Parameters modificiations

[Server Side Variables Names](https://github.com/antichown/burp-payloads/blob/master/Server-side%20variable%20names.pay)

|![](Images/image-20.png)|
|:--:| 
| *Parameters modificiations - Not valid username* |
|![](Images/image-21.png)|
| *Parameters modificiations - Truncating query string* |
|![](Images/image-22.png)|
| *Parameters modificiations - Truncating query string and extra parameter* |


### Finding correct parameter name
|![](Images/image-23.png)|
|:--:| 
| *Brute forcing correct field name* |
|![](Images/image-23.png)|
| *Brute forcing correct field name - email* |
|![](Images/image-25.png)|
| *Correct parameter found from source code - reset_token* |

### Retrieval of reset password token
|![](Images/image-26.png)|
|:--:| 
| *Parameters modificiations - Truncating query string and correct parameter name* |
| *Extraction of reset password token* |
|![](Images/image-27.png)|
| *Password reset and deletion of user Carlos* |













